
<html>
  <head>
    <style>
      #sayIt { font-size: 24px; font-family:courier; }
      p { margin-bottom: -12px; margin-left:105px; text-indent: -105px; }
    </style>
    <script type="module">

        var aScript6   ="{aScript6}"
     window.aScript6   =  aScript6

        var nCountries ="{nCountries = undefined}"
     window.nCountries =  nCountries

            say2("Head Module Script 5: can be before targeted <div> tag, but executes after <body> is rendered and Normal scripts are executed")   

     window.getCountries= getCountries           // need to make functions, to be used in later Module scripts, global 
      async function getCountries( nRows ) {     // need to await getCountries in Module script below 

        var mCountries = (await (await fetch( './assets/data/db.json' )).json()).countries  
        var nCountries =`{nCountries = ${ mCountries.length }}` 
      
//          say1("Head Module Script 6: can be before targeted <div> tag, but executes after <body> is rendered and Normal scripts are executed")   
            say1("Head Module Script 6: execute: `await (await fetch( './assets/data/db.json' )).json()` in function getCountries()")
//          say2(`Head Module Script 6: can see var, ${aScript6}, and var, ${nCountries}, assigned in same Module script`)

     return mCountries
            } 

  function  say1(a) { 
            pDiv = document.getElementById("sayIt")
            pDiv.innerHTML += "<p>say2: " + a.replace( /<(.+?)/g, '&lt;$1' ).replace( /(.+?)>/g, '$1&gt;') + "</p>"
            console.log(a) 
            }
    </script>            
  </head>

  <body>
 
    <div id="sayIt"></div>

    <script type="module">   // Can only use Normal Script functions, not those in any Module scripts 

        var aScript7="{aScript7}"
//          say1("Body Module Script 7: can be anywhere, but executes after <body> is rendered and Normal scripts are executed")   
            say2("Body Module Script 7: can be anywhere, but executes after <body> is rendered and Normal scripts are executed")   

        var mCountries =  await getCountries( ) 
        var nCountries =`{nCountries = ${ mCountries.length }}` 

            say2(`Body Module Script 8: can see var, ${aScript6}, and var, ${nCountries}, after await getCountries()`)
//          say3(`Body Module Script 8: can see var, ${aScript6}, and var, ${nCountries}, after await getCountries()`) 
    </script>
    <script>                 // Must be a Normal script for Module scripts to use it's functions 

  function  say2(a) { 
            pDiv = document.getElementById("sayIt")
            pDiv.innerHTML += "<p>say2: " + a.replace( /<(.+?)/g, '&lt;$1' ).replace( /(.+?)>/g, '$1&gt;') + "</p>"
            console.log(a) 
            }
    </script>
    <script type="module">   // Can't define Module Script functions to be used in any other scripts 

  function  say3(a) { 
            pDiv = document.getElementById("sayIt")
            pDiv.innerHTML += "<p>say3: " + a.replace( /<(.+?)/g, '&lt;$1' ).replace( /(.+?)>/g, '$1&gt;') + "</p>"
            console.log(a) 
            }
    </script>

  </body>
</html>  